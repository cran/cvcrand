<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hengshi Yu, John A. Gallis, Fan Li, and Elizabeth L. Turner" />

<meta name="date" content="2017-11-28" />

<title>cvcrand package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">cvcrand package</h1>
<h4 class="author"><em>Hengshi Yu, John A. Gallis, Fan Li, and Elizabeth L. Turner</em></h4>
<h4 class="date"><em>2017-11-28</em></h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>cvcrand is an R package for the design and analysis of cluster randomized trials (CRTs).</p>
<p>Given the baseline values of some cluster-level covariates, users can perform a constrained randomization on the clusters into two arms, with an optional input of user-defined weights on the covariates.</p>
<p>At the end of the study, the individual outcome is collected. The <code>cvcrand</code> package also performs clustered permutation test on either continuous outcome or binary outcome adjusted for some individual-level covariates, producing p-value of the intervention effect.</p>
</div>
<div id="design-constrained-randomization" class="section level2">
<h2>Design: constrained randomization</h2>
<p>In the design of CRTs with two arms, users can use the <code>cvcrand()</code> function to perform constrained randomization. And for the analysis part, user will use the <code>cptest()</code> function for clustered permutation test.</p>
<p>A cluster is the unit of randomization for a cluster randomized trial. Thus, when the number of clusters is small, there might be some baseline imbalance from the randomization between the arms. Constrained randomization constrained the randomization space to randomization schemes with smaller difference among the covariates between the two arms.</p>
<p>The balance score for constrained randomization in the program is developed from <span class="citation">(Raab and Butcher 2001)</span>. Suppose <span class="math inline">\(n\)</span>, <span class="math inline">\(n_T\)</span>, and <span class="math inline">\(n_C\)</span> are the total number of clusters, the number of clusters in the treatment arm and the control arm respectively. Suppose also that there are <span class="math inline">\(K\)</span> cluster-level variables including the continuous covariates as well as the dummy variables created from the categorical covariates. <span class="math inline">\(\bar{x}_{Tk}\)</span> and <span class="math inline">\(\bar{x}_{Ck}\)</span> are the means of the <span class="math inline">\(kth\)</span> variable in the treatment arm and the control arm respectively. <span class="math inline">\(\omega_k\)</span> is the inverse of the standard deviation of the <span class="math inline">\(kth\)</span> variable among all <span class="math inline">\(n\)</span> clusters. There are two choices of metric for the balance score. If <code>&quot;L1&quot;</code> metric is specified and there is no user-defined <code>weight</code> of <span class="math inline">\(C_k;\ k=1,2,...,K\)</span>, the balance score is defined as follows.</p>
<p><span class="math inline">\(B_{(l1)}=\left(\frac{n_Tn_C}{n}\right)\sum_{k=1}^{K}\omega_k\left|\bar{x}_{Tk}-\bar{x}_{Ck}\right|\)</span></p>
<p>And if there is user-defined <code>weight</code> of <span class="math inline">\(C_k;\ k=1,2,...,K\)</span>, the <code>&quot;L1&quot;</code> balance score is: <span class="math inline">\(B_{(l1)}=\left(\frac{n_Tn_C}{n}\right)\sum_{k=1}^{K}C_k\omega_k\left|\bar{x}_{Tk}-\bar{x}_{Ck}\right|\)</span>.</p>
<p>Another metric is <code>&quot;L2&quot;</code>. The balance score with and without the user-defined <code>weight</code> is defined as follows:</p>
<p><span class="math inline">\(B_{(l2)}=\left(\frac{n_Tn_C}{n}\right)^{2}\sum_{k=1}^{K}\omega_k^2(\bar{x}_{Tk}-\bar{x}_{Ck})^2\)</span> and <span class="math inline">\(B_{(l2)}=\left(\frac{n_Tn_C}{n}\right)^{2}\sum_{k=1}^{K}C_k^2\omega_k^2(\bar{x}_{Tk}-\bar{x}_{Ck})^2\)</span></p>
<p>With the baseline values of the specified cluster-level covariates in a cluster randomized trail, the <code>cvcrand()</code> function in the <code>cvcrand</code> package is used to perform the consrailed randomization.</p>
<p>Each categorical variable is transformed into dummy variables to calculate the balance score. Specifically, the level of each categorical variable dropped when it is transformed into several dummiy variables is the first level in the alphanumerical order. If the user wants to specify a different level of each categorical variable to drop, they might create dummy variables themselves before running the <code>cvcrand()</code> function. Then, the user needs to specify the dummy variables created themselves to be <code>&quot;categorical&quot;</code> when running <code>cvcrand()</code>.</p>
</div>
<div id="cvcrand-example" class="section level2">
<h2><code>cvcrand()</code> example</h2>
<p>Study 1 in <span class="citation">(L. M. Dickinson et al. 2015)</span> is about two approaches (interventions) for increasing the “up-to-date” immunization rate in 19- to 35-month-old children. They planned to randomize 16 counties in Colorado 1:1 to either a population-based approach or a practice-based approach. There are several county-level variables. The program will randomize on a subset of these variables. The continuous variable of average income is categorized to illustrate the use of the <code>cvcrand()</code> on multi-category variables. And the percentage in CIIS variable is trancated at 100%.</p>
<table>
<thead>
<tr class="header">
<th align="right">county</th>
<th align="left">location</th>
<th align="right">inciis</th>
<th align="right">uptodateonimmunizations</th>
<th align="right">hispanic</th>
<th align="left">incomecat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Rural</td>
<td align="right">85</td>
<td align="right">39</td>
<td align="right">23</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Rural</td>
<td align="right">85</td>
<td align="right">42</td>
<td align="right">12</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Rural</td>
<td align="right">93</td>
<td align="right">39</td>
<td align="right">18</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Rural</td>
<td align="right">82</td>
<td align="right">31</td>
<td align="right">6</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">Rural</td>
<td align="right">80</td>
<td align="right">27</td>
<td align="right">15</td>
<td align="left">Med</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">49</td>
<td align="right">38</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Rural</td>
<td align="right">100</td>
<td align="right">37</td>
<td align="right">39</td>
<td align="left">Low</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">Urban</td>
<td align="right">93</td>
<td align="right">51</td>
<td align="right">35</td>
<td align="left">Med</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">Urban</td>
<td align="right">89</td>
<td align="right">51</td>
<td align="right">17</td>
<td align="left">Med</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">Urban</td>
<td align="right">83</td>
<td align="right">54</td>
<td align="right">7</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">Urban</td>
<td align="right">70</td>
<td align="right">29</td>
<td align="right">13</td>
<td align="left">Med</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">Urban</td>
<td align="right">93</td>
<td align="right">50</td>
<td align="right">13</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">Urban</td>
<td align="right">85</td>
<td align="right">36</td>
<td align="right">10</td>
<td align="left">Med</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">Urban</td>
<td align="right">82</td>
<td align="right">38</td>
<td align="right">39</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">Urban</td>
<td align="right">84</td>
<td align="right">43</td>
<td align="right">28</td>
<td align="left">Med</td>
</tr>
</tbody>
</table>
<p>For the constrained randomization, we used the <code>cvcrand()</code> function to randomize 8 out of the 16 counties into the practice-based. For the definition of the whole randomization space, if the total number of all possible schemes is smaller than <code>50,000</code>, we enumerate all the schemes as the whole randomization space. Otherwise, we simulate <code>50,000</code> schemes and choose the unique shemes among them as the whole randomization space. We calculate the balance scores of <code>&quot;L2&quot;</code> metric on three continuous covariates as well as two categorical covariates of location and income category. Location has <code>&quot;Rural&quot;</code> and <code>&quot;Urban&quot;</code>. The level of <code>&quot;Rural&quot;</code> was then dropped in <code>cvcrand()</code>. As income category has three levels of <code>&quot;low&quot;</code>, <code>&quot;med&quot;</code>, and <code>&quot;high&quot;</code>, the level of <code>&quot;high&quot;</code> was dropped to create dummy variables according to the alphanumerical order as well. Then we constrained the randomization space to the schemes with <code>&quot;L2&quot;</code> balance scores less than the <code>0.1</code> quantile of that in the whole randomization space. Finally, a randomization scheme is sampled from the constrained space.</p>
<p>We saved the constrained randomization space in a CSV file in <code>&quot;dickinson_constrained.csv&quot;</code>, the first column of which is an indicator variable of the finally selected scheme (<code>1</code>) or not (<code>0</code>). We also saved the balance scores of the whole randomization space in a CSV file in <code>&quot;dickinson_bscores.csv&quot;</code>, and output a histogram displaying the distribution of all balance scores with a red line indicating our selected cutoff (the <code>0.1</code> quantile).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> Design_result&lt;-<span class="kw">cvcrand</span>(<span class="dt">id =</span> Dickinson_design$county,
                       <span class="dt">metric =</span> <span class="st">&quot;L2&quot;</span>,
                       <span class="dt">x =</span> <span class="kw">data.frame</span>(Dickinson_design[, -<span class="dv">1</span>]),
                       <span class="dt">n =</span> <span class="dv">16</span>,
                       <span class="dt">ntrt =</span> <span class="dv">8</span>,
                       <span class="dt">categorical =</span> <span class="kw">c</span>(<span class="st">&quot;location&quot;</span>,<span class="st">&quot;incomecat&quot;</span>),
                       <span class="dt">savedata =</span> <span class="st">&quot;dickinson_constrained.csv&quot;</span>,
                       <span class="dt">savebscores =</span> <span class="st">&quot;dickinson_bscores.csv&quot;</span>,
                       <span class="dt">cutoff =</span> <span class="fl">0.1</span>,
                       <span class="dt">seed =</span> <span class="dv">12345</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The we had the following output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the metric the user specified</span>
 Design_result$metric</code></pre></div>
<pre><code>## [1] &quot;L2&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the selected scheme </span>
 Design_result$Allocation</code></pre></div>
<pre><code>##       id allocation
##  [1,]  1          0
##  [2,]  2          0
##  [3,]  3          0
##  [4,]  4          1
##  [5,]  5          1
##  [6,]  6          0
##  [7,]  7          1
##  [8,]  8          0
##  [9,]  9          1
## [10,] 10          1
## [11,] 11          0
## [12,] 12          1
## [13,] 13          1
## [14,] 14          0
## [15,] 15          1
## [16,] 16          0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the cutoff balance score, the balance score of the selected   scheme, as well as the histogram of the balance scores of the whole randomization space</span>
 Design_result$Bscores</code></pre></div>
<pre><code>##   CR-Benchmark Selected Point           Mean             SD            Min             5% 
##       7.638463       6.763833      24.000000      15.774661       1.161107       5.826458 
##            10%            20%            25%            30%            50%            75% 
##       7.638463      10.848749      12.221264      13.839891      20.577839      31.620790 
##            95%            Max 
##      55.486080     116.656181</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the statement about how many clusters to randomize to the intervention and the control arms respectively</span>
 Design_result$assignment_message</code></pre></div>
<pre><code>## [1] &quot;You have indicated that you want to assign 8 clusters to treatment and 8 to control&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the statement about how to get the whole space of schemes</span>
 Design_result$scheme_message</code></pre></div>
<pre><code>## [1] &quot;Enumerating all the 12870 schemes for 8 clusters in the treatment arm out of 16 clusters in total&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the statement about the benchmark of the constrained space</span>
 Design_result$BLcut_message</code></pre></div>
<pre><code>## [1] &quot;By cutoff quantile of 0.1 of L2 , the BL constrained randomization benchmark is 7.638&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the statement about the selected scheme from constrained randomization</span>
 Design_result$BLchoice_message</code></pre></div>
<pre><code>## [1] &quot;Balance score of selected scheme by L2 has B score of 6.764&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the matrix containing allocation scheme, the id as well as the original covariates' matrix</span>
 Design_result$data_BL</code></pre></div>
<pre><code>##    inter id location inciis uptodateonimmunizations hispanic incomecat
## 1      0  1    Rural     94                      37       44       Low
## 2      0  2    Rural     85                      39       23      High
## 3      0  3    Rural     85                      42       12       Low
## 4      1  4    Rural     93                      39       18      High
## 5      1  5    Rural     82                      31        6      High
## 6      0  6    Rural     80                      27       15       Med
## 7      1  7    Rural     94                      49       38       Low
## 8      0  8    Rural    100                      37       39       Low
## 9      1  9    Urban     93                      51       35       Med
## 10     1 10    Urban     89                      51       17       Med
## 11     0 11    Urban     83                      54        7      High
## 12     1 12    Urban     70                      29       13       Med
## 13     1 13    Urban     93                      50       13      High
## 14     0 14    Urban     85                      36       10       Med
## 15     1 15    Urban     82                      38       39       Low
## 16     0 16    Urban     84                      43       28       Med</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># the descriptive statistics for all the variables in the original covariates' matrix in the two arms from constrained randomization</span>
 Design_result$BL_result</code></pre></div>
<pre><code>##                                      Stratified by inter
##                                       0             1             p      test
##   n                                       8             8                    
##   location = Urban (%)                    3 (37.5)      5 (62.5)   0.617     
##   inciis (mean (sd))                  87.00 (6.59)  87.00 (8.45)   1.000     
##   uptodateonimmunizations (mean (sd)) 39.38 (7.65)  42.25 (9.18)   0.507     
##   hispanic (mean (sd))                22.25 (13.77) 22.38 (12.94)  0.985     
##   incomecat (%)                                                    0.819     
##      High                                 2 (25.0)      3 (37.5)             
##      Low                                  3 (37.5)      2 (25.0)             
##      Med                                  3 (37.5)      3 (37.5)</code></pre>
<p>From the output of <code>Design_result$BL_result</code>, the selected scheme is able to properly balance the baseline values of the covariates. And the selected scheme is shown in <code>Design_result$Allocation</code>.</p>
</div>
<div id="analysis-clustered-permutation-test" class="section level2">
<h2>Analysis: Clustered Permutation Test</h2>
<p>At the end of cluster randomized trials, individual outcomes are collected. Permutation test based on <span class="citation">(Gail et al. 1996)</span> and <span class="citation">(Li et al. 2016)</span> is then applied to the continuous or binary outcome with some individual-level covariates.</p>
<p>The <code>cptest()</code> function in the <code>cvcrand</code> package is used to perform the permutation test for the intervention effect of cluster randomized trials.</p>
<p>Each categorical variable is transformed into dummy variables to fit in the linear model or logistic regression for the permutation test. Specifically, the level of each categorical variable dropped when it is transformed into several dummiy variables is the first level in the alphanumerical order. If the user wants to specify a different level of each categorical variable to drop, they might create dummy variables themselves before running the <code>cptest()</code> function. Then, the user needs to specify the dummy variables created themselves to be <code>&quot;categorical&quot;</code> when running <code>cptest()</code>.</p>
</div>
<div id="cptest-example" class="section level2">
<h2><code>cptest()</code> example</h2>
<p>Suppose that the researchers were able to assess 300 children in each cluster of the study 1 in <span class="citation">(L. M. Dickinson et al. 2015)</span>, and the cluster randomized trial is processed with the selected randomization scheme from the example above of the <code>cvcrand()</code> function. We expanded the values of the cluster-level covariates on the covariates’ values of the individuals, according to which cluster they belong to. The correlated individual outcome of up-to-date on immunizations (<code>1</code>) or not (<code>0</code>) is then simulated using a generalized linear mixed model (GLMM) to induce correlation by include a random effect. The intracluster correlation (ICC) was set to be 0.01, using the latent response definition provided in <span class="citation">(Eldridge, Ukoumunne, and Carlin 2009)</span>. This is a reasonable value of the ICC the population health studies <span class="citation">(Hannan et al. 1994)</span>. We simulated one data set, with the outcome data dependent on the county-level covariates used in the constrained randomization design and a positive treatment effect so that the practice-based intervention increases up-to-date immunization rates more than the community-based intervention. For each individual child, the outcome is equal to <code>1</code> if he or she is up-to-date on immunizations and <code>0</code> otherwise.</p>
<table>
<thead>
<tr class="header">
<th align="right">county</th>
<th align="left">location</th>
<th align="right">inciis</th>
<th align="right">uptodateonimmunizations</th>
<th align="right">hispanic</th>
<th align="right">incomecat</th>
<th align="right">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">Rural</td>
<td align="right">94</td>
<td align="right">37</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>We used the <code>cptest()</code> function to process the clustered permutation test on the binary outcome of the status of up-to-date on immunizations. We input the file about the constrained space with the first column indicating the final scheme. The permutation test is on the continuous covariates of <code>&quot;inciis&quot;</code>, <code>&quot;uptodateonimmunizations&quot;</code>, <code>&quot;hispanic&quot;</code>, as well as categorical variables of <code>&quot;location&quot;</code> and <code>&quot;incomecat&quot;</code>. Location has <code>&quot;Rural&quot;</code> and <code>&quot;Urban&quot;</code>. The level of <code>&quot;Rural&quot;</code> was then dropped in <code>cptest()</code>. As income category has three levels of <code>&quot;low&quot;</code>, <code>&quot;med&quot;</code>, and <code>&quot;high&quot;</code>, the level of <code>&quot;high&quot;</code> was dropped to create dummy variables according to the alphanumerical order as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> Analysis_result &lt;-<span class="st"> </span><span class="kw">cptest</span>(<span class="dt">outcome =</span> Dickinson_outcome$outcome,
                           <span class="dt">id =</span> Dickinson_outcome$county,
                           <span class="dt">x =</span> <span class="kw">data.frame</span>(Dickinson_outcome[, <span class="kw">c</span>(-<span class="dv">1</span>, -<span class="dv">7</span>)]),
                           <span class="dt">cspacedatname =</span> <span class="kw">system.file</span>(<span class="st">&quot;dickinson_constrained.csv&quot;</span>, <span class="dt">package=</span><span class="st">&quot;cvcrand&quot;</span>),
                           <span class="dt">outcometype =</span> <span class="st">&quot;binary&quot;</span>,
                           <span class="dt">categorical =</span> <span class="kw">c</span>(<span class="st">&quot;location&quot;</span>,<span class="st">&quot;incomecat&quot;</span>))</code></pre></div>
<p>The result of <code>&quot;cptest()&quot;</code> includes the final scheme for the cluster randomized trial, the p-value from the permutation test as well as a statement about that p-value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> Analysis_result </code></pre></div>
<pre><code>## $FinalScheme
##    Cluster_ID Intervention
## 1           1            0
## 2           2            0
## 3           3            0
## 4           4            1
## 5           5            1
## 6           6            0
## 7           7            1
## 8           8            0
## 9           9            1
## 10         10            1
## 11         11            0
## 12         12            1
## 13         13            1
## 14         14            0
## 15         15            1
## 16         16            0
## 
## $pvalue
## [1] 0.0497
## 
## $pvalue_statement
## [1] &quot;Adjusted permutation test p-value = 0.0497&quot;</code></pre>
<p>From the p-value of <code>0.0497</code> in <code>Analysis_result</code>, the probability of up-to-date on immunizations for the practice-based approach (<code>1</code>) is significantly different from that for the population-based approach (<code>0</code>).</p>
</div>
<div id="session-information" class="section level1">
<h1>Session Information</h1>
<pre><code>## R Under development (unstable) (2017-07-03 r72882)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 16299)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=C                           LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] cvcrand_0.0.1
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.11    lattice_0.20-35 zoo_1.8-0       class_7.3-14    digest_0.6.12   rprojroot_1.2  
##  [7] MASS_7.3-47     grid_3.5.0      backports_1.1.0 magrittr_1.5    e1071_1.6-8     evaluate_0.10.1
## [13] survey_3.32-1   highr_0.6       stringi_1.1.5   Matrix_1.2-10   rmarkdown_1.8   splines_3.5.0  
## [19] tools_3.5.0     stringr_1.2.0   survival_2.41-3 yaml_2.1.14     compiler_3.5.0  htmltools_0.3.6
## [25] knitr_1.17      tableone_0.8.1</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-dickinson2015pragmatic">
<p>Dickinson, L Miriam, Brenda Beaty, Chet Fox, Wilson Pace, W Perry Dickinson, Caroline Emsermann, and Allison Kempe. 2015. “Pragmatic Cluster Randomized Trials Using Covariate Constrained Randomization: A Method for Practice-Based Research Networks (Pbrns).” <em>The Journal of the American Board of Family Medicine</em> 28 (5). Am Board Family Med: 663–72.</p>
</div>
<div id="ref-eldridge2009intra">
<p>Eldridge, Sandra M, Obioha C Ukoumunne, and John B Carlin. 2009. “The Intra-Cluster Correlation Coefficient in Cluster Randomized Trials: A Review of Definitions.” <em>International Statistical Review</em> 77 (3). Wiley Online Library: 378–94.</p>
</div>
<div id="ref-gail1996design">
<p>Gail, Mitchell H, Steven D Mark, Raymond J Carroll, Sylvan B Green, and David Pee. 1996. “On Design Considerations and Randomization-Based Inference for Community Intervention Trials.” <em>Statistics in Medicine</em> 15 (11). Wiley Online Library: 1069–92.</p>
</div>
<div id="ref-hannan1994parameters">
<p>Hannan, Peter J, David M Murray, David R Jacobs Jr, and Paul G McGovern. 1994. “Parameters to Aid in the Design and Analysis of Community Trials: Intraclass Correlations from the Minnesota Heart Health Program.” <em>Epidemiology</em>. JSTOR, 88–95.</p>
</div>
<div id="ref-li2016evaluation">
<p>Li, Fan, Yuliya Lokhnygina, David M Murray, Patrick J Heagerty, and Elizabeth R DeLong. 2016. “An Evaluation of Constrained Randomization for the Design and Analysis of Group-Randomized Trials.” <em>Statistics in Medicine</em> 35 (10). Wiley Online Library: 1565–79.</p>
</div>
<div id="ref-raab2001balance">
<p>Raab, Gillian M, and Izzy Butcher. 2001. “Balance in Cluster Randomized Trials.” <em>Statistics in Medicine</em> 20 (3). Wiley Online Library: 351–65.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
